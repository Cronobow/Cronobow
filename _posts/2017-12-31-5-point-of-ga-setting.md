---
layout: post
title: "五個 Google Analytics 初期設置要點"
date: 2017-12-31 22:21:15 +0800
comments: true
tags:
- google analytics
---
一般來說，要開始啟用一個網站的 GA 追蹤數據蒐集，只要將 GA 追蹤碼放到網站中，直接設置追蹤碼，或使用 GTM，一個步驟就能完成。然而還是有一些小細節要注意一下，這邊提出五項初期設置要點：

<!-- more --> 
### 1. 排除自身流量與限定主機流量

網頁開發初期，一定會有許多測試頁面的點擊瀏覽，即便到上線後，通常也不希望追蹤到公司內部的瀏覽數據，利用篩選器 「排除自己的 IP」，是最簡單的方法。

設置的位置在 `GA管理介面 > 資料檢視 > 篩選器` 中把公司和家中的 IP，設定為排除。

另外，如果是另有測試用網站，或是在本地主機做測試，開發版本的追蹤代碼沒有移除，就會蒐集到測試版本的數據。這時，也可以透過篩選器中的「主機名稱」，設定「只包含」自己的網域。這樣測試網域和 localhost 的數據就不會被收集了。

{% include image.html path="2017/GA-setting-1.png" alt="GA-setting-1" %}

小提醒，篩選器設置後，所有數據都不會收錄進資料檢視中，所以務必保留一份原始資料（不設任何篩選器），以防設定錯誤導致不可逆的後果。

### 2. 設定參照連結排除清單

如果你的網站有使用第三方支付，或其他合作商網站，在操作流程時會有短暫跳離主站，經過一些動作又跳轉回來的狀況，可以把這些網站放入參照連結排除清單，避免蒐集到一些非必要的參照連結資訊。

設定的位置在 `GA管理介面 > 資源 > 追蹤資訊 > 參照連結網址排除清單`，可加入排除的網站。

### 3. 設定工作階段逾時時間

GA 的工作階段的逾時時間，是預設 30 分鐘，大部分的情況使用預設值即可。不過如果你的業種特殊，例如影音播放或直撥平台，使用者雖然長時間不操作頁面，但其實仍在使用你的服務，就需要調整工作階段逾時時間。

調整的位置在 `GA管理介面 > 資源 > 追蹤資訊 > 工作階段設定` 內調整。

### 4. 設定查詢參數

現在大部分的網站，無論是內容型或電商，都會有站內搜尋的功能，將站內搜尋的關鍵字查詢參數設定好，就能在 GA 報表中統計站內搜尋的字詞，提供進一步優化的參考。

設定的位置在 `GA管理介面 > 資料檢視 > 檢視設定 > 查詢參數` 中，只要指定查詢時，關鍵字的前綴參數即可。

以本站來說，搜尋 `GA` 這個字時，網址是 https://maxlab.tw/?s=GA，只要把 `s` 放進查詢參數設置即可。

### 5. 設定 forceSSL

如果你的網站已經設定好 SSL 憑證 (https) ，但有用戶會連進 http 開頭的網址（以前的連結…等等），這樣同一個頁面就可能產生兩種資料（http & https），GA 預設並不會幫你整合，所以可以在追蹤碼上將 forceSSL 的屬性設定為 true，將所有流量資訊都放到 https 的網址內。設定的方法有二：

1. 傳統埋入 GA 追蹤碼，加入一行  
```javascript
ga('create', 'UA-XXXX-Y', 'auto');
ga('set', 'forceSSL', true);  // 加入這行
ga('send', 'pageview');
```

2. 或是使用 GTM，在 GA 追蹤代碼的變數中設定  
{% include image.html path="2017/GA-setting-2.png" alt="GA-setting-2" %}

恭喜你，這樣就完成基本的設定了。

### 其他選用的小調整

另外，有兩個參數，分別在流量很大的網站，以及流量很小的網站，建議做調整

1. 設定 sampleRate  
如果你的網站流量已經很大了，會超過 GA 蒐集量的上限，可以藉由這個參數限制取樣率，預設是 100%。

2. 設定 siteSpeedSampleRate  
在 GA 的「行為」報表中，有一個「網站速度」的報表很好用，可以協助找出特別慢或是有問題的頁面。

{% include image.html path="2017/GA-setting-3.png" alt="GA-setting-3" %}

但 siteSpeedSampleRate 的預設取樣率是 1%，以上述約 300 人的小流量的頁面，不到 3 個人能提供速度資訊，非常不準。建議初期可以調整成 100%。

改變上述兩個取樣率的方法，用 GTM 比較方便，設置方式同 forceSSL，若是傳統埋入追蹤碼，方法如下:

將這行刪掉 `ga('create', 'UA-XXXX-Y', 'auto');`，改成下面這樣

```javascript
ga('create', 'UA-XXXX-Y', {
   'sampleRate': 100,           //數字為取樣率
   'siteSpeedSampleRate': 100   //數字為取樣率
});
```
